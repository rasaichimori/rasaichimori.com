<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
    <title>Gravity Balls (unfinished)</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="icon" href="../favicon.png">
		<style>
			body{
				margin: 0;
				font-family: montserrat;
			}
			.lightbox{
				position: fixed;
				top:0px;
				width: 100%;
				height: 100%;
				z-index: -1;
			}
			.back-menu{
				position: absolute;
				left: 50%;
				transform: translateX(-50%);
				bottom: 70px;
			}
			.back-menu a{
				padding-right: 50px;
				padding-left: 50px;
				color: white;
				text-decoration: none;
			}
			.title{
				padding-top: 50px;
				font-family: poppins;
				color: gray;
				letter-spacing: 10px;
				text-align: center;
			}
			.site-footer li{
				font-family: lineto;
				color: white;
			}
			.site-footer li a{
				color: white;
			}
		</style>
    <meta name="description" content="make some cool sounds with them circles" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script> 
  </head>
    
  <body>
			<div class = "title">
<!--						<h1>social dots</h1>-->
			</div>
			<div class = "back-menu">
				<a href="../index.html">home</a>
				<a href="../projects.html">projects</a>
			</div>
			<div class="p5canvas" id="p5canvas">
			</div>
			<script>
				
		function changeSize(){
			resizeCanvas(1200, 1200*window.innerHeight/window.innerWidth, false);
			p5canvas.canvas.style.width = window.innerWidth+"px";
			p5canvas.canvas.style.height = window.innerHeight+"px";
		}
		window.addEventListener('resize', changeSize);


		Alldots = [];
		class dot {
			constructor(x, y, xs, ys, id) {
				this.x = x;
				this.y = y;
				this.xs = xs;
				this.ys = ys;
				this.id = id;
				this.size = 25;
				this.speed = 0;
				this.drag = 0.99;
				this.test = 0;
			}

			border() {
				if (this.x > width-this.size/2 || this.x < this.size/2) {
					this.x = constrain(this.x, this.size/2, width-this.size/2);
					this.xs *= -1;
				}
				if (this.y > height-this.size/2 || this.y < this.size/2) {
					this.y = constrain(this.y, this.size/2, height-this.size/2);
					this.ys *= -1;
				}
			}

			move() {
				var f = 4;
				this.xs *= this.drag;
				this.ys *= this.drag;
				this.speed = sqrt(pow(this.xs,2)+pow(this.ys,2));
				this.ys+=0.6;
				for (var i = this.id+1; i < Alldots.length; i++) {
					var d = dist(this.x, this.y, Alldots[i].x, Alldots[i].y);
					if(i>this.id){
						var cx = (this.x-Alldots[i].x);
						var cy = (this.y-Alldots[i].y);
						var cs = (this.size+Alldots[i].size)/2;
						var collisionX = 0;
						var collisionY = 0;
						if(d<cs){
							collisionX = (((cs*cx)/d)-cx)/2;
							collisionY = (((cs*cy)/d)-cy)/2;
							this.hit = true;
						}
						else{
							this.hit = false;
						}
						this.x += collisionX;
						this.y += collisionY;
						Alldots[i].x -= collisionX;
						Alldots[i].y -= collisionY;
						if(this.hit){
							this.xs += ((this.x-Alldots[i].x)/(this.size))*(this.speed+Alldots[i].speed)/f;
							this.ys += ((this.y-Alldots[i].y)/(this.size))*(this.speed+Alldots[i].speed)/f;
							Alldots[i].xs += ((Alldots[i].x-this.x)/(Alldots[i].size))*(Alldots[i].speed+this.speed)/f;
							Alldots[i].ys += ((Alldots[i].y-this.y)/(Alldots[i].size))*(Alldots[i].speed+this.speed)/f;
						}
					}
				}
				this.x += this.xs;
				this.y += this.ys;
			}

			display() {
				fill(255, 155, 0);
				ellipse(this.x, this.y, this.size);
			}
		}
		function setup(){
			p5canvas = createCanvas(10,10);
			p5canvas.parent('p5canvas');
			var v = createVector(0, 0);
			changeSize();
			for (var i = 0; i < 50; i++) {
				Alldots[i] = new dot(
					random(0, width), //xposition
					random(0, height), //yposition
					random(-6, 6), //xspeed
					random(-6, 6), //yspeed
					i
				);
			}
			angleMode(DEGREES);
		}
		function draw(){
			background(0);
			Alldots.forEach(dot => {
				// if(mouseIsPressed)
				{
					dot.move();
				}
				dot.border();
				dot.display();
			});
		};
			</script>
		
			<footer class="site-footer">
						<li>&copy;2022<a href="index.html"> rasaichimori</a>
						</li><!-- .footer-copyright -->
			</footer><!-- #site-footer -->
  </body>
</html>